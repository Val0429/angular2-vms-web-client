<div class="animated fadeIn"><div class="row">
    <div class="col-12">
      <div class="card">
        <button type="button" class="btn btn-primary" data-toggle="modal" (click)="newRecognition(); largeModal.show()">
          New Face Recognition
        </button>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <i class="fa fa-align-justify"></i>Face Recognition
        </div>
        <div class="card-block">
          <table datatable class="table table-striped table-hover" [mfData]="data" #mf="mfDataTable" [mfRowsOnPage]="10">
            <thead>
              <tr>
                <th style="width: 5%">No</th>
                <th style="width: 20%">Source</th>
                <th style="width: 20%">Location</th>
                <th style="width: 15%">Type</th>
                <th style="width: 20%">IP Address</th>
                <th style="width: 10%">Score</th>
                <th style="width: 5%"></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of mf.data; let i = index; async">
                <td>{{i + 1}}</td>
                <td>{{item.video_source_sourceid}}</td>
                <td>{{item.video_source_location}}</td>
                <td>{{item.video_source_type}}</td>
                <td>{{item.video_source_ip}}</td>
                <td>{{item.face_verify_target_sorce}}</td>
                <td>
                    <a class="fa fa-pencil fa-lg" style="cursor: pointer;" (click)="$event.stopPropagation();modifyRecognition(item); largeModal.show()"></a>
                    <a class="fa fa-remove fa-lg" style="cursor: pointer;" (click)="$event.stopPropagation();deleteRecognition(item)"></a>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td colspan="4">
                    <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15,20]"></mfBootstrapPaginator>
                </td>
              </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>


<div bsModal #largeModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="vertical-alignment-helper">
    <div class="modal-dialog vertical-align-center">

      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">

          <div class="modal-header">
            <h4 class="modal-title">{{model.title}}</h4>
            <button type="button" class="close" (click)="largeModal.hide()" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form #recognitionForm="ngForm" action="javascript:void(0);" (ngSubmit)="recognitionForm.valid && onFormSubmit(recognitionForm); largeModal.hide();">
            <div class="modal-body">
              <div class="card mx-2">
                <div class="card-block p-2">
                    <!-- video_source_sourceid, video_source_location -->                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': video_source_sourceid.invalid && (video_source_sourceid.dirty || video_source_sourceid.touched), 'has-success': video_source_sourceid.valid && (video_source_sourceid.dirty || video_source_sourceid.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="video_source_sourceid" name="video_source_sourceid" #video_source_sourceid="ngModel"
                                [ngClass]="{ 'form-control-danger': video_source_sourceid.invalid && (video_source_sourceid.dirty || video_source_sourceid.touched), 'form-control-success': video_source_sourceid.valid && (video_source_sourceid.dirty || video_source_sourceid.touched)}"
                            placeholder="Identification" [(ngModel)]="model.settings.video_source_sourceid">
                            </div>
                            <div style="color:red" *ngIf="video_source_sourceid.errors && (video_source_sourceid.dirty || video_source_sourceid.touched || video_source_sourceid.submitted)">
                            <p *ngIf="video_source_sourceid.errors.required">
                                The Identification is required
                            </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': video_source_location.invalid && (video_source_location.dirty || video_source_location.touched), 'has-success': video_source_location.valid && (video_source_location.dirty || video_source_location.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="video_source_location" name="video_source_location" #video_source_location="ngModel"
                                [ngClass]="{ 'form-control-danger': video_source_location.invalid && (video_source_location.dirty || video_source_location.touched), 'form-control-success': video_source_location.valid && (video_source_location.dirty || video_source_location.touched)}"
                                placeholder="Location" [(ngModel)]="model.settings.video_source_location">
                            </div>
                            <div style="color:red" *ngIf="video_source_location.errors && (video_source_location.dirty || video_source_location.touched || video_source_location.submitted)">
                            <p *ngIf="video_source_location.errors.required">
                                The Location is required
                            </p>
                            </div>
                        </div>
                    </div>

                    <!-- video_source_type, video_source_ip, video_source_port, ((video_source_nce_id)) -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            
                            <label class="radio-inline" style="margin-top: 8px; margin-right: 10px;margin-left: 8px;" for="nvr">
                                <input type="radio" id="nvr" name="nvr" [value]="nvr" [(ngModel)]="model.settings.video_source_type" [checked]="model.settings.video_source_type===nvr"> NVR
                            </label>
                            <label class="radio-inline" style="margin-top: 8px; margin-right: 10px;" for="cms">
                                <input type="radio" id="cms" name="cms" [value]="cms" [(ngModel)]="model.settings.video_source_type" [checked]="model.settings.video_source_type===cms"> CMS
                            </label>
                            <label class="radio-inline" style="margin-top: 8px; margin-right: 10px;" for="rtsp">
                                <input type="radio" id="rtsp" name="rtsp" [value]="3" [(ngModel)]="model.settings.video_source_type" [checked]="model.settings.video_source_type==3"> RTSP
                            </label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': video_source_ip.invalid && (video_source_ip.dirty || video_source_ip.touched), 'has-success': video_source_ip.valid && (video_source_ip.dirty || video_source_ip.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="video_source_ip" name="video_source_ip" #video_source_ip="ngModel"
                                [ngClass]="{ 'form-control-danger': video_source_ip.invalid && (video_source_ip.dirty || video_source_ip.touched), 'form-control-success': video_source_ip.valid && (video_source_ip.dirty || video_source_ip.touched)}"
                                placeholder="IP Address" [(ngModel)]="model.settings.video_source_ip">
                            </div>
                            <div style="color:red" *ngIf="video_source_ip.errors && (video_source_ip.dirty || video_source_ip.touched || video_source_ip.submitted)">
                            <p *ngIf="video_source_ip.errors.required">
                                The IP Address is required
                            </p>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': video_source_port.invalid && (video_source_port.dirty || video_source_port.touched), 'has-success': video_source_port.valid && (video_source_port.dirty || video_source_port.touched)}">
                            <input type="text" class="form-control" required id="video_source_port" name="video_source_port" #video_source_port="ngModel"
                                [ngClass]="{ 'form-control-danger': video_source_port.invalid && (video_source_port.dirty || video_source_port.touched), 'form-control-success': video_source_port.valid && (video_source_port.dirty || video_source_port.touched)}"
                                placeholder="Port" [(ngModel)]="model.settings.video_source_port">
                            </div>
                            <div style="color:red" *ngIf="video_source_port.errors && (video_source_port.dirty || video_source_port.touched || video_source_port.submitted)">
                            <p *ngIf="video_source_port.errors.required">
                                The Port is required
                            </p>
                            </div>
                        </div>
                    </div>

                    <!-- video_source_channel, video_source_rtsp_path -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" id="video_source_channel" name="video_source_channel" #video_source_channel="ngModel"
                                placeholder="Channel" [(ngModel)]="model.settings.video_source_channel">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" id="video_source_rtsp_path" name="video_source_rtsp_path" #video_source_rtsp_path="ngModel"
                                placeholder="RTSP Path" [(ngModel)]="model.settings.video_source_rtsp_path">
                            </div>
                        </div>
                    </div>

                    <!-- video_source_username, video_source_password -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': video_source_username.invalid && (video_source_username.dirty || video_source_username.touched), 'has-success': video_source_username.valid && (video_source_username.dirty || video_source_username.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="video_source_username" name="video_source_username" #video_source_username="ngModel"
                                [ngClass]="{ 'form-control-danger': video_source_username.invalid && (video_source_username.dirty || video_source_username.touched), 'form-control-success': video_source_username.valid && (video_source_username.dirty || video_source_username.touched)}"
                                placeholder="Username" [(ngModel)]="model.settings.video_source_username">
                            </div>
                            <div style="color:red" *ngIf="video_source_username.errors && (video_source_username.dirty || video_source_username.touched || video_source_username.submitted)">
                            <p *ngIf="video_source_username.errors.required">
                                The Username is required
                            </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': video_source_password.invalid && (video_source_password.dirty || video_source_password.touched), 'has-success': video_source_password.valid && (video_source_password.dirty || video_source_password.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="video_source_password" name="video_source_password" #video_source_password="ngModel"
                                [ngClass]="{ 'form-control-danger': video_source_password.invalid && (video_source_password.dirty || video_source_password.touched), 'form-control-success': video_source_password.valid && (video_source_password.dirty || video_source_password.touched)}"
                                placeholder="Password" [(ngModel)]="model.settings.video_source_password">
                            </div>
                            <div style="color:red" *ngIf="video_source_password.errors && (video_source_password.dirty || video_source_password.touched || video_source_password.submitted)">
                            <p *ngIf="video_source_password.errors.required">
                                The Password is required
                            </p>
                            </div>
                        </div>
                    </div>

                    <!-- video_decode_key_frame_only, face_capture_biggest_only -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="checkbox" style="margin-top: 5px; margin-left: 8px;" id="video_decode_key_frame_only" name="video_decode_key_frame_only" #video_decode_key_frame_only="ngModel" [(ngModel)]="model.settings.video_decode_key_frame_only">
                            <span style="margin-top: 8px; margin-left: 8px;">Decode Key Frame Only</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="checkbox" style="margin-top: 5px;margin-left: 8px;" id="face_capture_biggest_only" name="face_capture_biggest_only" #face_capture_biggest_only="ngModel" [(ngModel)]="model.settings.face_capture_biggest_only">
                            <span style="margin-top: 8px; margin-left: 8px;">Face Capture Biggest Only</span>
                            </div>
                        </div>
                    </div>

                    <!-- min_face_size_width, min_face_size_height -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': min_face_size_width.invalid && (min_face_size_width.dirty || min_face_size_width.touched), 'has-success': min_face_size_width.valid && (min_face_size_width.dirty || min_face_size_width.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="min_face_size_width" name="min_face_size_width" #min_face_size_width="ngModel"
                                [ngClass]="{ 'form-control-danger': min_face_size_width.invalid && (min_face_size_width.dirty || min_face_size_width.touched), 'form-control-success': min_face_size_width.valid && (min_face_size_width.dirty || min_face_size_width.touched)}"
                                placeholder="Minimum Face Width" [(ngModel)]="model.settings.min_face_size_width">
                            </div>
                            <div style="color:red" *ngIf="min_face_size_width.errors && (min_face_size_width.dirty || min_face_size_width.touched || min_face_size_width.submitted)">
                            <p *ngIf="min_face_size_width.errors.required">
                                The Minimum Face Width is required
                            </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': min_face_size_height.invalid && (min_face_size_height.dirty || min_face_size_height.touched), 'has-success': min_face_size_height.valid && (min_face_size_height.dirty || min_face_size_height.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="min_face_size_height" name="min_face_size_height" #min_face_size_height="ngModel"
                                [ngClass]="{ 'form-control-danger': min_face_size_height.invalid && (min_face_size_height.dirty || min_face_size_height.touched), 'form-control-success': min_face_size_height.valid && (min_face_size_height.dirty || min_face_size_height.touched)}"
                                placeholder="Minimum Face Height" [(ngModel)]="model.settings.min_face_size_height">
                            </div>
                            <div style="color:red" *ngIf="min_face_size_height.errors && (min_face_size_height.dirty || min_face_size_height.touched || min_face_size_height.submitted)">
                            <p *ngIf="min_face_size_height.errors.required">
                                The Minimum Face Height is required
                            </p>
                            </div>
                        </div>
                    </div>

                    <!-- face_capture_time_interval, face_capture_mirror_image -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': face_capture_time_interval.invalid && (face_capture_time_interval.dirty || face_capture_time_interval.touched), 'has-success': face_capture_time_interval.valid && (face_capture_time_interval.dirty || face_capture_time_interval.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="face_capture_time_interval" name="face_capture_time_interval" #face_capture_time_interval="ngModel"
                                [ngClass]="{ 'form-control-danger': face_capture_time_interval.invalid && (face_capture_time_interval.dirty || face_capture_time_interval.touched), 'form-control-success': face_capture_time_interval.valid && (face_capture_time_interval.dirty || face_capture_time_interval.touched)}"
                                placeholder="Minimum Face Width" [(ngModel)]="model.settings.face_capture_time_interval">
                            </div>
                            <div style="color:red" *ngIf="face_capture_time_interval.errors && (face_capture_time_interval.dirty || face_capture_time_interval.touched || face_capture_time_interval.submitted)">
                            <p *ngIf="face_capture_time_interval.errors.required">
                                The Minimum Face Width is required
                            </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="checkbox" style="margin-top: 5px; margin-left: 8px;" id="face_capture_mirror_image" name="face_capture_mirror_image" #face_capture_mirror_image="ngModel" [(ngModel)]="model.settings.face_capture_mirror_image">
                            <span style="margin-top: 8px; margin-left: 8px;">Face Capture Mirror Image</span>
                            </div>
                        </div>
                    </div>

                    <!-- face_verify_target_sorce, face_verify_action_enable -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': face_verify_target_sorce.invalid && (face_verify_target_sorce.dirty || face_verify_target_sorce.touched), 'has-success': face_verify_target_sorce.valid && (face_verify_target_sorce.dirty || face_verify_target_sorce.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="face_verify_target_sorce" name="face_verify_target_sorce" #face_verify_target_sorce="ngModel"
                                [ngClass]="{ 'form-control-danger': face_verify_target_sorce.invalid && (face_verify_target_sorce.dirty || face_verify_target_sorce.touched), 'form-control-success': face_verify_target_sorce.valid && (face_verify_target_sorce.dirty || face_verify_target_sorce.touched)}"
                                placeholder="Target Score" [(ngModel)]="model.settings.face_verify_target_sorce">
                            </div>
                            <div style="color:red" *ngIf="face_verify_target_sorce.errors && (face_verify_target_sorce.dirty || face_verify_target_sorce.touched || face_verify_target_sorce.submitted)">
                            <p *ngIf="face_verify_target_sorce.errors.required">
                                The Target Score is required
                            </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="checkbox" style="margin-top: 5px; margin-left: 8px;" id="face_verify_action_enable" name="face_verify_action_enable" #face_verify_action_enable="ngModel" [(ngModel)]="model.settings.face_verify_action_enable">
                            <span style="margin-top: 8px; margin-left: 8px;">Face Verify Action Enable</span>
                            </div>
                        </div>
                    </div>

                    <!-- max_buffering_video_frames, face_verify_action_enable -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': max_buffering_video_frames.invalid && (max_buffering_video_frames.dirty || max_buffering_video_frames.touched), 'has-success': max_buffering_video_frames.valid && (max_buffering_video_frames.dirty || max_buffering_video_frames.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="max_buffering_video_frames" name="max_buffering_video_frames" #max_buffering_video_frames="ngModel"
                                [ngClass]="{ 'form-control-danger': max_buffering_video_frames.invalid && (max_buffering_video_frames.dirty || max_buffering_video_frames.touched), 'form-control-success': max_buffering_video_frames.valid && (max_buffering_video_frames.dirty || max_buffering_video_frames.touched)}"
                                placeholder="Maximum Buffering Video Frames" [(ngModel)]="model.settings.max_buffering_video_frames">
                            </div>
                            <div style="color:red" *ngIf="max_buffering_video_frames.errors && (max_buffering_video_frames.dirty || max_buffering_video_frames.touched || max_buffering_video_frames.submitted)">
                            <p *ngIf="max_buffering_video_frames.errors.required">
                                The Maximum Buffering Video Frames is required
                            </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="input-group mb-1" 
                                [ngClass]="{ 'has-danger': max_uploading_threads.invalid && (max_uploading_threads.dirty || max_uploading_threads.touched), 'has-success': max_uploading_threads.valid && (max_uploading_threads.dirty || max_uploading_threads.touched)}">
                            <span class="input-group-addon"><i class="icon-user"></i></span>
                            <input type="text" class="form-control" required id="max_uploading_threads" name="max_uploading_threads" #max_uploading_threads="ngModel"
                                [ngClass]="{ 'form-control-danger': max_uploading_threads.invalid && (max_uploading_threads.dirty || max_uploading_threads.touched), 'form-control-success': max_uploading_threads.valid && (max_uploading_threads.dirty || max_uploading_threads.touched)}"
                                placeholder="Maximum Uploading Threads" [(ngModel)]="model.settings.max_uploading_threads">
                            </div>
                            <div style="color:red" *ngIf="max_uploading_threads.errors && (max_uploading_threads.dirty || max_uploading_threads.touched || max_uploading_threads.submitted)">
                            <p *ngIf="max_uploading_threads.errors.required">
                                The Maximum Uploading Threads is required
                            </p>
                            </div>
                        </div>
                    </div>

                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" (click)="largeModal.hide()">Close</button>
              <button type="submit" class="btn btn-primary" [disabled]="!recognitionForm.valid">{{model.buttom}}</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>